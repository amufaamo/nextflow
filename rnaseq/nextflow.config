/*
 * ================================================================================================
 * ğŸ³ Nextflow Configuration File
 * ================================================================================================
 */

params {
    // å®Ÿè¡Œãƒ­ã‚°ãªã©ã‚’ä¿å­˜ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
    tracedir = "${params.outdir}/pipeline_info"
}

// ãƒ—ãƒ­ã‚»ã‚¹å…±é€šè¨­å®šï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã®å†è©¦è¡Œãªã©ï¼‰
process {
    errorStrategy = { task.exitStatus in [143,137,104,134,139] ? 'retry' : 'finish' }
    maxRetries    = 2
}

// ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å®šç¾©
profiles {
    // standardãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«: ä½•ã‚‚æŒ‡å®šã—ãªã„å ´åˆã«é©ç”¨ã•ã‚Œã¾ã™
    standard {
        apptainer.enabled    = true
        apptainer.autoMounts = true
        docker.enabled       = false
    }

    // æ˜ç¤ºçš„ã«æŒ‡å®šã—ãŸå ´åˆ
    apptainer {
        apptainer.enabled    = true
        apptainer.autoMounts = true
        docker.enabled       = false
    }

    docker {
        docker.enabled       = true
        docker.runOptions    = '-u $(id -u):$(id -g)'
        apptainer.enabled    = false
    }
}

// ãƒ¬ãƒãƒ¼ãƒˆè¨­å®š
def trace_timestamp = new java.util.Date().format( 'yyyy-MM-dd_HH-mm-ss')
timeline {
    enabled = true
    file    = "${params.tracedir}/execution_timeline_${trace_timestamp}.html"
}
report {
    enabled = true
    file    = "${params.tracedir}/execution_report_${trace_timestamp}.html"
}
