/*
 * ================================================================================================
 * ğŸ³ Nextflow Configuration File
 * ================================================================================================
 */

params {
    // --- å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè¨­å®š ---
    tracedir = "${params.outdir}/pipeline_info"
    
    // --- â˜…ã“ã“ã‚’è¿½åŠ ï¼(å…±é€šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤) ---
    // ã“ã‚Œã‚’æ›¸ãã“ã¨ã§ã€è­¦å‘Š(WARN)ãŒæ¶ˆãˆã¦ã€å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å€¤ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™
    single_end        = false 
    adapter_fasta     = "${System.getProperty("user.home")}/fasta/adapter.fasta"
    fastq_dir         = "${System.getProperty("user.home")}/fastq"
    outdir            = "results"
    cpus              = 8
    
    // --- FeatureCountsç”¨è¨­å®š ---
    fc_group_features = 'gene_id'
    
    // â˜…ã“ã“ã‚’è¿½åŠ ï¼šSTARã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆæ™‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ãƒã‚¦ã‚¹/ãƒ’ãƒˆç”¨ã®14)
    star_index_nbases = 14

    // --- De novoç”¨è¨­å®š ---
    denovo = false // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯Ref-based
    busco_lineage = "eukaryota_odb10" // é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„
    busco_download_path = "./busco_downloads"
}

process {
    // ã‚¨ãƒ©ãƒ¼æ™‚ã®å†è©¦è¡Œè¨­å®š
    errorStrategy = { task.exitStatus in [143,137,104,134,139] ? 'retry' : 'finish' }
    maxRetries    = 2
}

profiles {
    standard {
        apptainer.enabled    = true
        apptainer.autoMounts = true
        docker.enabled       = false
    }

    apptainer {
        apptainer.enabled    = true
        apptainer.autoMounts = true
        docker.enabled       = false
    }

    docker {
        docker.enabled       = true
        docker.runOptions    = '-u $(id -u):$(id -g)'
        apptainer.enabled    = false
    }
}

def trace_timestamp = new java.util.Date().format( 'yyyy-MM-dd_HH-mm-ss')
timeline {
    enabled = true
    file    = "${params.tracedir}/execution_timeline_${trace_timestamp}.html"
}
report {
    enabled = true
    file    = "${params.tracedir}/execution_report_${trace_timestamp}.html"
}